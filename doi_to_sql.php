<?php

// Import DOIs as SQL

require_once (dirname(__FILE__) . '/csl_utils.php');

//----------------------------------------------------------------------------------------
function get($url, $content_type = '')
{	
	$data = null;

	$opts = array(
	  CURLOPT_URL =>$url,
	  CURLOPT_FOLLOWLOCATION => TRUE,
	  CURLOPT_RETURNTRANSFER => TRUE,
	  
	  CURLOPT_SSL_VERIFYHOST=> FALSE,
	  CURLOPT_SSL_VERIFYPEER=> FALSE,
	  
	);

	if ($content_type != '')
	{
		$opts[CURLOPT_HTTPHEADER] = array(
			"Accept: " . $content_type 
		);		
	}
	
	$ch = curl_init();
	curl_setopt_array($ch, $opts);
	$data = curl_exec($ch);
	$info = curl_getinfo($ch); 
	curl_close($ch);
	
	return $data;
}

//----------------------------------------------------------------------------------------
function doi_to_agency(&$prefix_to_agency, $prefix, $doi)
{
	$agency = '';
			
	if (isset($prefix_to_agency[$prefix]))
	{
		$agency = $prefix_to_agency[$prefix];
	}
	else
	{
		$url = 'https://doi.org/ra/' . $doi;	
		$json = get($url);
		$obj = json_decode($json);	
		if ($obj)
		{
			if (isset($obj[0]->RA))
			{
				$agency = $obj[0]->RA;		
				$prefix_to_agency[$prefix] = $agency;
			}	
		}
	}
	
	return $agency;
}

//----------------------------------------------------------------------------------------
$prefix_filename = dirname(__FILE__) . '/prefix.json';

if (file_exists($prefix_filename))
{
	$json = file_get_contents($prefix_filename);
	$prefix_to_agency = json_decode($json, true);
}
else
{
	$prefix_to_agency = array();
}

$dois=array();

$dois=array(
'10.5635/ASED.2012.28.4.230',
);


$dois = array(
'10.3406/BSEF.1996.17243',
'10.11646/zootaxa.1390.1.3',
'10.21248/contrib.entomol.23.1-4.57-69', 	// DataCite
'10.19269/sugapa2020.13(1).01', 			//mEDRA
'10.11238/mammalianscience.58.175', 		// JaLC
);


$dois=array(
"10.5656/KSAE.2011.03.0.011",
"10.5656/KSAE.2011.03.0.008",
"10.5656/KSAE.2011.03.1.077",
"10.5656/KSAE.2011.03.0.005",
"10.5656/KSAE.2011.03.0.006",
"10.5656/KSAE.2011.03.0.007",
"10.5656/KSAE.2011.02.0.002",
"10.5656/KSAE.2011.03.0.001",
"10.5656/KSAE.2011.02.1.068",
"10.5656/KSAE.2011.01.1.088",
"10.5656/KSAE.2010.09.0.058",
"10.5656/KSAE.2010.04.0.014",
"10.5656/KSAE.2007.46.2.175",
"10.5656/KSAE.2007.46.2.183",
"10.5656/KSAE.2007.46.2.193",
"10.5656/KSAE.2007.46.2.201",
"10.5656/KSAE.2007.46.2.213",
"10.5656/KSAE.2007.46.2.221",
"10.5656/KSAE.2007.46.2.229",
"10.5656/KSAE.2007.46.2.235",
"10.5656/KSAE.2007.46.2.251",
"10.5656/KSAE.2007.46.2.261",
"10.5656/KSAE.2007.46.2.269",
"10.5656/KSAE.2007.46.2.281",
"10.5656/KSAE.2007.46.2.287",
"10.5656/KSAE.2007.46.2.295",
"10.5656/KSAE.2007.46.2.303",
"10.5656/KSAE.2007.46.2.313",
"10.5656/KSAE.2007.46.2.319",
"10.5656/KSAE.2007.46.2.325",
"10.5656/KSAE.2007.46.2.275",
"10.5656/KSAE.2007.46.3.331",
"10.5656/KSAE.2007.46.3.343",
"10.5656/KSAE.2007.46.3.425",
"10.5656/KSAE.2007.46.3.375",
"10.5656/KSAE.2007.46.3.335",
"10.5656/KSAE.2007.46.3.431",
"10.5656/KSAE.2007.46.3.349",
"10.5656/KSAE.2007.46.3.385",
"10.5656/KSAE.2007.46.3.409",
"10.5656/KSAE.2007.46.3.363",
"10.5656/KSAE.2007.46.3.437",
"10.5656/KSAE.2007.46.3.357",
"10.5656/KSAE.2007.46.3.393",
"10.5656/KSAE.2007.46.3.415",
"10.5656/KSAE.2007.46.3.401",
"10.5656/KSAE.2008.47.1.107",
"10.5656/KSAE.2008.47.1.101",
"10.5656/KSAE.2008.47.1.095",
"10.5656/KSAE.2008.47.1.087",
"10.5656/KSAE.2008.47.1.075",
"10.5656/KSAE.2008.47.1.065",
"10.5656/KSAE.2008.47.1.059",
"10.5656/KSAE.2008.47.1.051",
"10.5656/KSAE.2008.47.1.045",
"10.5656/KSAE.2008.47.1.037",
"10.5656/KSAE.2008.47.1.031",
"10.5656/KSAE.2008.47.1.023",
"10.5656/KSAE.2008.47.1.017",
"10.5656/KSAE.2008.47.1.009",
"10.5656/KSAE.2008.47.1.001",
"10.5656/KSAE.2008.47.1.005",
"10.5656/KSAE.2008.47.2.185",
"10.5656/KSAE.2008.47.2.175",
"10.5656/KSAE.2008.47.2.169",
"10.5656/KSAE.2008.47.2.163",
"10.5656/KSAE.2008.47.2.155",
"10.5656/KSAE.2008.47.2.149",
"10.5656/KSAE.2008.47.2.141",
"10.5656/KSAE.2008.47.2.133",
"10.5656/KSAE.2008.47.2.127",
"10.5656/KSAE.2008.47.2.117",
"10.5656/KSAE.2008.47.2.111",
"10.5656/KSAE.2008.47.4.309",
"10.5656/KSAE.2008.47.4.315",
"10.5656/KSAE.2008.47.4.333",
"10.5656/KSAE.2008.47.4.337",
"10.5656/KSAE.2008.47.4.345",
"10.5656/KSAE.2008.47.4.353",
"10.5656/KSAE.2008.47.4.359",
"10.5656/KSAE.2008.47.4.365",
"10.5656/KSAE.2008.47.4.369",
"10.5656/KSAE.2008.47.4.379",
"10.5656/KSAE.2008.47.4.385",
"10.5656/KSAE.2008.47.4.395",
"10.5656/KSAE.2008.47.4.401",
"10.5656/KSAE.2008.47.4.407",
"10.5656/KSAE.2008.47.4.413",
"10.5656/KSAE.2008.47.4.421",
"10.5656/KSAE.2008.47.4.429",
"10.5656/KSAE.2008.47.4.435",
"10.5656/KSAE.2008.47.4.447",
"10.5656/KSAE.2008.47.4.457",
"10.5656/KSAE.2008.47.4.467",
"10.5656/KSAE.2008.47.4.473",
"10.5656/KSAE.2008.47.4.479",
"10.5656/KSAE.2008.47.4.487",
"10.5656/KSAE.2008.47.4.491",
"10.5656/KSAE.2008.47.3.189",
"10.5656/KSAE.2008.47.3.193",
"10.5656/KSAE.2008.47.3.201",
"10.5656/KSAE.2008.47.3.209",
"10.5656/KSAE.2008.47.3.217",
"10.5656/KSAE.2008.47.3.227",
"10.5656/KSAE.2008.47.3.237",
"10.5656/KSAE.2008.47.3.249",
"10.5656/KSAE.2008.47.3.255",
"10.5656/KSAE.2008.47.3.273",
"10.5656/KSAE.2008.47.3.265",
"10.5656/KSAE.2008.47.3.287",
"10.5656/KSAE.2008.47.3.293",
"10.5656/KSAE.2008.47.3.299",
"10.5656/KSAE.2008.47.3.303",
"10.5656/KSAE.2009.48.1.117",
"10.5656/KSAE.2009.48.1.109",
"10.5656/KSAE.2009.48.1.101",
"10.5656/KSAE.2009.48.2.269",
"10.5656/KSAE.2009.48.1.095",
"10.5656/KSAE.2009.48.1.087",
"10.5656/KSAE.2009.48.2.263",
"10.5656/KSAE.2009.48.1.081",
"10.5656/KSAE.2009.48.1.073",
"10.5656/KSAE.2009.48.2.253",
"10.5656/KSAE.2009.48.2.245",
"10.5656/KSAE.2009.48.1.067",
"10.5656/KSAE.2009.48.1.059",
"10.5656/KSAE.2009.48.2.237",
"10.5656/KSAE.2009.48.1.053",
"10.5656/KSAE.2009.48.2.229",
"10.5656/KSAE.2009.48.1.045",
"10.5656/KSAE.2009.48.1.037",
"10.5656/KSAE.2009.48.2.221",
"10.5656/KSAE.2009.48.1.029",
"10.5656/KSAE.2009.48.2.211",
"10.5656/KSAE.2009.48.1.011",
"10.5656/KSAE.2009.48.1.021",
"10.5656/KSAE.2009.48.1.005",
"10.5656/KSAE.2009.48.2.203",
"10.5656/KSAE.2009.48.3.393",
"10.5656/KSAE.2009.48.2.197",
"10.5656/KSAE.2009.48.1.001",
"10.5656/KSAE.2009.48.2.189",
"10.5656/KSAE.2009.48.3.385",
"10.5656/KSAE.2009.48.2.179",
"10.5656/KSAE.2009.48.3.377",
"10.5656/KSAE.2009.48.2.171",
"10.5656/KSAE.2009.48.3.369",
"10.5656/KSAE.2009.48.2.165",
"10.5656/KSAE.2009.48.2.159",
"10.5656/KSAE.2009.48.3.361",
"10.5656/KSAE.2009.48.2.123",
"10.5656/KSAE.2009.48.3.355",
"10.5656/KSAE.2009.48.3.335",
"10.5656/KSAE.2009.48.3.347",
"10.5656/KSAE.2009.48.3.327",
"10.5656/KSAE.2009.48.3.319",
"10.5656/KSAE.2009.48.3.311",
"10.5656/KSAE.2009.48.3.301",
"10.5656/KSAE.2009.48.3.295",
"10.5656/KSAE.2009.48.4.403",
"10.5656/KSAE.2009.48.3.285",
"10.5656/KSAE.2009.48.3.275",
"10.5656/KSAE.2009.48.4.411",
"10.5656/KSAE.2009.48.4.417",
"10.5656/KSAE.2009.48.3.281",
"10.5656/KSAE.2009.48.4.423",
"10.5656/KSAE.2009.48.4.431",
"10.5656/KSAE.2009.48.4.439",
"10.5656/KSAE.2009.48.4.447",
"10.5656/KSAE.2009.48.4.453",
"10.5656/KSAE.2009.48.4.459",
"10.5656/KSAE.2009.48.4.479",
"10.5656/KSAE.2009.48.4.467",
"10.5656/KSAE.2009.48.4.485",
"10.5656/KSAE.2009.48.4.493",
"10.5656/KSAE.2009.48.4.503",
"10.5656/KSAE.2009.48.4.509",
"10.5656/KSAE.2009.48.4.519",
"10.5656/KSAE.2009.48.4.527",
"10.5656/KSAE.2009.48.4.535",
"10.5656/KSAE.2009.48.4.553",
"10.5656/KSAE.2009.48.4.541",
"10.5656/KSAE.2009.48.4.547",
"10.5656/KSAE.2007.46.1.169",
"10.5656/KSAE.2007.46.1.165",
"10.5656/KSAE.2007.46.1.159",
"10.5656/KSAE.2007.46.1.153",
"10.5656/KSAE.2007.46.1.147",
"10.5656/KSAE.2007.46.1.141",
"10.5656/KSAE.2007.46.1.131",
"10.5656/KSAE.2007.46.1.123",
"10.5656/KSAE.2007.46.1.117",
"10.5656/KSAE.2007.46.1.109",
"10.5656/KSAE.2007.46.1.097",
"10.5656/KSAE.2007.46.1.087",
"10.5656/KSAE.2007.46.1.079",
"10.5656/KSAE.2007.46.1.071",
"10.5656/KSAE.2007.46.1.063",
"10.5656/KSAE.2007.46.1.057",
"10.5656/KSAE.2007.46.1.051",
"10.5656/KSAE.2007.46.1.043",
"10.5656/KSAE.2007.46.1.037",
"10.5656/KSAE.2007.46.1.027",
"10.5656/KSAE.2007.46.1.013",
"10.5656/KSAE.2007.46.1.019",
"10.5656/KSAE.2007.46.1.001",
"10.5656/KSAE.2007.46.1.005",
"10.5656/KSAE.2011.06.0.21",
"10.5656/KSAE.2011.06.0.30",
"10.5656/KSAE.2011.06.0.28",
"10.5656/KSAE.2011.06.0.23",
"10.5656/KSAE.2011.06.0.18",
"10.5656/KSAE.2011.04.0.16",
"10.5656/KSAE.2011.05.0.17",
"10.5656/KSAE.2011.04.0.15",
"10.5656/KSAE.2011.03.0.12",
"10.5656/KSAE.2011.06.0.10",
"10.5656/KSAE.2010.49.1.061",
"10.5656/KSAE.2010.49.2.083",
"10.5656/KSAE.2010.49.2.089",
"10.5656/KSAE.2010.49.2.093",
"10.5656/KSAE.2010.49.4.429",
"10.5656/KSAE.2010.49.2.097",
"10.5656/KSAE.2010.49.4.423",
"10.5656/KSAE.2010.49.2.115",
"10.5656/KSAE.2010.49.2.129",
"10.5656/KSAE.2010.49.4.417",
"10.5656/KSAE.2010.49.4.409",
"10.5656/KSAE.2010.49.4.401",
"10.5656/KSAE.2010.49.4.393",
"10.5656/KSAE.2010.49.1.057",
"10.5656/KSAE.2010.49.1.049",
"10.5656/KSAE.2010.49.2.145",
"10.5656/KSAE.2010.49.4.385",
"10.5656/KSAE.2010.49.2.151",
"10.5656/KSAE.2010.49.1.043",
"10.5656/KSAE.2010.49.4.375",
"10.5656/KSAE.2010.49.2.167",
"10.5656/KSAE.2010.49.2.069",
"10.5656/KSAE.2010.49.4.371",
"10.5656/KSAE.2010.49.4.363",
"10.5656/KSAE.2010.49.2.105",
"10.5656/KSAE.2010.49.2.123",
"10.5656/KSAE.2010.49.3.171",
"10.5656/KSAE.2010.49.2.139",
"10.5656/KSAE.2010.49.1.037",
"10.5656/KSAE.2010.49.3.175",
"10.5656/KSAE.2010.49.4.357",
"10.5656/KSAE.2010.49.2.159",
"10.5656/KSAE.2010.49.3.187",
"10.5656/KSAE.2010.49.2.163",
"10.5656/KSAE.2010.49.1.031",
"10.5656/KSAE.2010.49.4.351",
"10.5656/KSAE.2010.49.3.199",
"10.5656/KSAE.2010.49.4.343",
"10.5656/KSAE.2010.49.1.023",
"10.5656/KSAE.2010.49.3.205",
"10.5656/KSAE.2010.49.1.017",
"10.5656/KSAE.2010.49.1.011",
"10.5656/KSAE.2010.49.4.333",
"10.5656/KSAE.2010.49.3.211",
"10.5656/KSAE.2010.49.4.325",
"10.5656/KSAE.2010.49.3.227",
"10.5656/KSAE.2010.49.4.313",
"10.5656/KSAE.2010.49.3.219",
"10.5656/KSAE.2010.49.4.305",
"10.5656/KSAE.2010.49.3.233",
"10.5656/KSAE.2010.49.4.299",
"10.5656/KSAE.2010.49.3.241",
"10.5656/KSAE.2010.49.4.289",
"10.5656/KSAE.2010.49.4.277",
"10.5656/KSAE.2010.49.1.001",
"10.5656/KSAE.2010.49.4.273",
"10.5656/KSAE.2010.49.4.269",
"10.5656/KSAE.2010.49.4.265",
"10.5656/KSAE.2010.49.3.251",
"10.5656/KSAE.2010.49.3.261",
"10.5656/KSAE.2010.49.1.005",
"10.5656/KSAE.2011.09.0.52",
"10.5656/KSAE.2011.11.0.61",
"10.5656/KSAE.2011.12.0.67",
"10.5656/KSAE.2011.11.0.72",
"10.5656/KSAE.2011.09.0.49",
"10.5656/KSAE.2011.10.0.62",
"10.5656/KSAE.2011.11.0.66",
"10.5656/KSAE.2011.10.0.60",
"10.5656/KSAE.2011.11.0.59",
"10.5656/KSAE.2011.10.0.57",
"10.5656/KSAE.2011.09.0.56",
"10.5656/KSAE.2011.10.0.53",
"10.5656/KSAE.2011.10.0.54",
"10.5656/KSAE.2011.09.0.48",
"10.5656/KSAE.2011.09.0.43",
"10.5656/KSAE.2011.10.0.41",
"10.5656/KSAE.2011.10.0.38",
"10.5656/KSAE.2011.11.0.31",
"10.5656/KSAE.2012.01.1.081",
"10.5656/KSAE..2012.01.1.071",
"10.5656/KSAE.2012.01.0.001",
"10.5656/KSAE.2011.12.0.070",
"10.5656/KSAE.2011.12.0.076",
"10.5656/KSAE.2011.12.0.065",
"10.5656/KSAE.2012.01.1.064",
"10.5656/KSAE.2012.01.1.058",
"10.5656/KSAE.2012.01.1.063",
"10.5656/KSAE.2012.01.1.055",
"10.5656/KSAE.2012.04.0.24",
"10.5656/KSAE.2012.04.1.83",
"10.5656/KSAE.2012.03.0.15",
"10.5656/KSAE.2012.03.0.14",
"10.5656/KSAE.2012.02.0.02",
"10.5656/KSAE.2012.04.0.21",
"10.5656/KSAE.2012.04.0.08",
"10.5656/KSAE.2012.03.0.18",
"10.5656/KSAE.2012.02.0.04",
"10.5656/KSAE.2012.02.1.73",
"10.5656/KSAE.2012.01.1.69",
"10.5656/KSAE.2011.07.0.29",
"10.5656/KSAE.2011.07.0.20",
"10.5656/KSAE.2011.08.0.37",
"10.5656/KSAE.2011.08.0.40",
"10.5656/KSAE.2011.09.0.39",
"10.5656/KSAE.2011.07.0.36",
"10.5656/KSAE.2011.07.034",
"10.5656/KSAE.2011.09.0.33",
"10.5656/KSAE.2011.07.0.32",
"10.5656/KSAE.2011.07.027",
"10.5656/KSAE.2011.07.026",
"10.5656/KSAE.2011.07.0.24",
"10.5656/KSAE.2012.06.0.036",
"10.5656/KSAE.2012.06.0.020",
"10.5656/KSAE.2012.05.0.033",
"10.5656/KSAE.2012.06.0.028",
"10.5656/KSAE.2012.06.0.016",
"10.5656/KSAE.2012.07.0.003",
"10.5656/KSAE.2012.06.0.009",
"10.5656/KSAE.2012.06.0.035",
"10.5656/KSAE.2012.06.0.013",
"10.5656/KSAE.2012.05.0.034",
"10.5656/KSAE.2012.05.0.029",
"10.5656/KSAE.2012.04.0.012",
"10.5656/KSAE.2012.03.1.085",
"10.5656/KSAE.2012.02.1.084",
"10.5656/KSAE.2012.04.0.11",
"10.5656/KSAE.2012.11.0.058",
"10.5656/KSAE.2012.10.0.049",
"10.5656/KSAE.2012.11.0.066",
"10.5656/KSAE.2012.11.0.048",
"10.5656/KSAE.2012.10.0.061",
"10.5656/KSAE.2012.10.0.055",
"10.5656/KSAE.2012.10.0.056",
"10.5656/KSAE.2012.10.0.032",
"10.5656/KSAE.2012.10.0.031",
"10.5656/KSAE.2012.10.0.057",
"10.5656/KSAE.2012.10.0.060",
"10.5656/KSAE.2012.09.0.010",
"10.5656/KSAE.2012.09.0.052",
"10.5656/KSAE.2012.09.0.054",
"10.5656/KSAE.2012.09.0.051",
"10.5656/KSAE.2012.09.0.022",
"10.5656/KSAE.2012.09.0.037",
"10.5656/KSAE.2012.09.0.046",
"10.5656/KSAE.2012.09.0.038",
"10.5656/KSAE.2012.08.0.042",
"10.5656/KSAE.2012.08.0.023",
"10.5656/KSAE.2012.07.0.007",
"10.5656/KSAE.2012.07.0.040",
"10.5656/KSAE.2012.07.1.074",
"10.5656/KSAE.2012.07.0.017",
"10.5656/KSAE.2013.01.0.001",
"10.5656/KSAE.2013.03.3.001",
"10.5656/KSAE.2012.11.0.053",
"10.5656/KSAE.2013.01.1.071",
"10.5656/KSAE.2012.10.0.065",
"10.5656/KSAE.2013.01.1.080",
"10.5656/KSAE.2013.01.1.075",
"10.5656/KSAE.2013.01.1.082",
"10.5656/KSAE.2012.12.0.073",
"10.5656/KSAE.2012.11.0.030",
"10.5656/KSAE.2012.10.0.041",
"10.5656/KSAE.2013.02.1.070",
"10.5656/KSAE.2013.03.0.007",
"10.5656/KSAE.2013.04.1.086",
"10.5656/KSAE.2013.01.0.002",
"10.5656/KSAE.2013.01.1.076",
"10.5656/KSAE.2013.03.0.012",
"10.5656/KSAE.2013.03.0.011",
"10.5656/KSAE.2013.02.0.004",
"10.5656/KSAE.2013.02.1.085",
"10.5656/KSAE.2013.02.1.072",
"10.5656/KSAE.2012.12.0.078",
"10.5656/KSAE.2013.02.1.062",
"10.5656/KSAE.2013.07.0.040",
"10.5656/KSAE.2013.07.0.032",
"10.5656/KSAE.2013.07.0.014",
"10.5656/KSAE.2013.06.0.029",
"10.5656/KSAE.2013.04.1.079",
"10.5656/KSAE.2013.06.0.025",
"10.5656/KSAE.2013.06.0.033",
"10.5656/KSAE.2013.05.0.027",
"10.5656/KSAE.2013.04.0.016",
"10.5656/KSAE.2013.05.0.009",
"10.5656/KSAE.2013.04.0.010",
"10.5656/KSAE.2013.04.0.008",
"10.5656/KSAE.2013.04.0.015",
"10.5656/KSAE.2013.02.1.068",
"10.5656/KSAE.2013.08.0.038",
"10.5656/KSAE.2013.11.0.079",
"10.5656/KSAE.2013.11.0.081",
"10.5656/KSAE.2013.11.0.076",
"10.5656/KSAE.2013.09.1.050",
"10.5656/KSAE.2013.11.0.078",
"10.5656/KSAE.2013.08.0.035",
"10.5656/KSAE.2013.11.0.066",
"10.5656/KSAE.2013.11.0.077",
"10.5656/KSAE.2013.10.0.054",
"10.5656/KSAE.2013.11.0.072",
"10.5656/KSAE.2013.10.0.055",
"10.5656/KSAE.2013.10.0.067",
"10.5656/KSAE.2013.10.0.058",
"10.5656/KSAE.2013.09.0.047",
"10.5656/KSAE.2013.08.0.053",
"10.5656/KSAE.2013.08.0.019",
"10.5656/KSAE.2013.08.0.036",
"10.5656/KSAE.2013.08.0.030",
"10.5656/KSAE.2013.09.0.042",
"10.5656/KSAE.2013.08.0.034",
"10.5656/KSAE.2013.08.0.037",
"10.5656/KSAE.2013.08.0.024",
"10.5656/KSAE.2013.07.0.017",
"10.5656/KSAE.2013.07.0.043",
"10.5656/KSAE.2013.09.0.052",
"10.5656/KSAE.2014.01.0.003",
"10.5656/KSAE.2014.01.1.069",
"10.5656/KSAE.2013.11.0.063",
"10.5656/KSAE.2013.11.0.062",
"10.5656/KSAE.2013.10.1.083",
"10.5656/KSAE.2013.09.0.041",
"10.5656/KSAE.2013.09.0.046",
"10.5656/KSAE.2013.09.1.081",
"10.5656/KSAE.2013.09.0.049",
"10.5656/KSAE.2013.09.0.028",
"10.5656/KSAE.2013.08.0.045",
"10.5656/KSAE.2014.02.1.084",
"10.5656/KSAE.2013.11.0.073",
"10.5656/KSAE.2014.03.0.016",
"10.5656/KSAE.2014.03.0.009",
"10.5656/KSAE.2014.03.1.059",
"10.5656/KSAE.2014.03.0.001",
"10.5656/KSAE.2014.03.0.013",
"10.5656/KSAE.2014.01.1.075",
"10.5656/KSAE.2013.11.1.061",
"10.5656/KSAE.2013.11.0.056",
"10.5656/KSAE.2014.01.1.083",
"10.5656/KSAE.2013.12.0.070",
"10.5656/KSAE.2014.04.0.019",
"10.5656/KSAE.2014.07.0.029",
"10.5656/KSAE.2014.09.3.001",
"10.5656/KSAE.2014.07.0.034",
"10.5656/KSAE.2014.05.0.008",
"10.5656/KSAE.2014.07.0.017",
"10.5656/KSAE.2014.06.0.021",
"10.5656/KSAE.2014.04.0.014",
"10.5656/KSAE.2014.08.0.032",
"10.5656/KSAE.2014.08.0.027",
"10.5656/KSAE.2014.06.0.012",
"10.5656/KSAE.2014.06.0.025",
"10.5656/KSAE.2014.01.1.071",
"10.5656/KSAE.2014.06.0.006",
"10.5656/KSAE.2014.03.1.082",
"10.5656/KSAE.2014.05.0.020",
"10.5656/KSAE.2014.04.0.018",
"10.5656/KSAE.2014.",
"10.5656/KSAE.2014.06.0.011",
"10.5656/KSAE.2014.09.0.041",
"10.5656/KSAE.2014.09.0.026",
"10.5656/KSAE.2014.09.0.042",
"10.5656/KSAE.2014.09.0.035",
"10.5656/KSAE.2014.10.0.043",
"10.5656/KSAE.2014.10.0.044",
"10.5656/KSAE.2014.10.0.047",
"10.5656/KSAE.2014.10.0.054",
"10.5656/KSAE.2014.10.0.059",
"10.5656/KSAE.2014.10.0.023",
"10.5656/KSAE.2014.10.0.036",
"10.5656/KSAE.2014.10.0.056",
"10.5656/KSAE.2014.11.0.033",
"10.5656/KSAE.2014.11.0.050",
"10.5656/KSAE.2014.11.0.058",
"10.5656/KSAE.2014.08.0.005",
"10.5656/KSAE.2014.08.0.028",
"10.5656/KSAE.2014.09.0.038",
"10.5656/KSAE.2014.09.0.040",
"10.5656/KSAE.2014.11.0.057",
"10.5656/KSAE.2014.11.0.048",
"10.5656/KSAE.2014.11.0.061",
"10.5656/KSAE.2014.11.0.064",
"10.5656/KSAE.2015.01.1.",
"10.5656/KSAE.2015.01.1.055",
"10.5656/KSAE.2015.01.1.066",
"10.5656/KSAE.2014.07.1.050",
"10.5656/KSAE.2015.01.1.070",
"10.5656/KSAE.2015.01.1.060",
"10.5656/KSAE.2015.01.1.063",
"10.5656/KSAE.2015.01.1.051",
"10.5656/KSAE.2015.01.1.052",
"10.5656/KSAE.2015.01.1.053",
"10.5656/KSAE.2014.01.1.074",
"10.5656/KSAE.2015.03.1.",
"10.5656/KSAE.2015.03.1.073",
"10.5656/KSAE.2015.03.1.069",
"10.5656/KSAE.2015.03.0.007",
"10.5656/KSAE.2015.04.0.003",
"10.5656/KSAE.2015.04.0.004",
"10.5656/KSAE.2015.05.0.020",
"10.5656/KSAE.2015.03.1.072",
"10.5656/KSAE.2015.03.1.068",
"10.5656/KSAE.2015.04.0.010",
"10.5656/KSAE.2015.04.0.015",
"10.5656/KSAE.2015.04.1.030",
"10.5656/KSAE.2015.06.3.001",
"10.5656/KSAE.2015.05.",
"10.5656/KSAE.2015.05.0.021",
"10.5656/KSAE.2015.06.0.019",
"10.5656/KSAE.2015.05.0.006",
"10.5656/KSAE.2015.06.0.011",
"10.5656/KSAE.2015.06.0.016",
"10.5656/KSAE.2015.06.0.024",
"10.5656/KSAE.2015.07.0.025",
"10.5656/KSAE.2015.07.0.034",
"10.5656/KSAE.2015.06.0.008",
"10.5656/KSAE.2015.08.0.040",
"10.5656/KSAE.2015.05.0.009",
"10.5656/KSAE.2015.04.0.005",
"10.5656/KSAE.2015.06.0.018",
"10.5656/KSAE.2015.06.0.027",
"10.5656/KSAE.2015.08.0.037",
"10.5656/KSAE.2015.07.0.035",
"10.5656/KSAE.2015.08.0.039",
"10.5656/KSAE.2015.08.0.030",
"10.5656/KSAE.2015.08.0.028",
"10.5656/KSAE.2015.08.0.029",
"10.5656/KSAE.2015.08.0.032",
"10.5656/KSAE.2015.09.0.038",
"10.5656/KSAE.2015.09.0.043",
"10.5656/KSAE.2015.09.0.054",
"10.5656/KSAE.2015.09.0.053",
"10.5656/KSAE.2015.10.0.048",
"10.5656/KSAE.2015.10.0.052",
"10.5656/KSAE.2015.10.0.056",
"10.5656/KSAE.2015.10.0.057",
"10.5656/KSAE.2015.11.0.066",
"10.5656/KSAE.2015.10.0.046",
"10.5656/KSAE.2015.10.0.065",
"10.5656/KSAE.2015.11.0.069",
"10.5656/KSAE.2015.10.0.045",
"10.5656/KSAE.2015.11.0.072",
"10.5656/KSAE.2015.10.0.055",
"10.5656/KSAE.2015.11.0.067",
"10.5656/KSAE.2015.11.1.071",
"10.5656/KSAE.2015.06.3.002",
"10.5656/KSAE.2015.06.3.003",
"10.5656/KSAE.2015.10.0.031",
"10.5656/KSAE.2015.11.0.051",
"10.5656/KSAE.2016.01.1.074",
"10.5656/KSAE.2015.05.0.078",
"10.5656/KSAE.2015.12.0.064",
"10.5656/KSAE.2016.01.1.059",
"10.5656/KSAE.2016.01.1.076",
"10.5656/KSAE.2015.11.0.062",
"10.5656/KSAE.2015.12.0.063",
"10.5656/KSAE.2016.01.1.075",
"10.5656/KSAE.2016.03.3.001",
"10.5656/KSAE.2016.03.3.002",
"10.5656/KSAE.2016.02.0.004",
"10.5656/KSAE.2016.03.0.001",
"10.5656/KSAE.2016.03.0.006",
"10.5656/KSAE.2016.03.0.009",
"10.5656/KSAE.2016.05.0.014",
"10.5656/KSAE.2016.04.0.011",
"10.5656/KSAE.2016.05.0.019",
"10.5656/KSAE.2016.05.0.015",
"10.5656/KSAE.2016.03.0.002",
"10.5656/KSAE.2016.05.0.022",
"10.5656/KSAE.2016.02.1.049",
"10.5656/KSAE.2016.04.1.079",
"10.5656/KSAE.2016.05.0.003",
"10.5656/KSAE.2016.05.0.007",
"10.5656/KSAE.2016.05.0.028",
"10.5656/KSAE.2016.05.0.018",
"10.5656/KSAE.2016.06.0.025",
"10.5656/KSAE.2016.06.0.017",
"10.5656/KSAE.2016.06.0.024",
"10.5656/KSAE.2016.07.0.034",
"10.5656/KSAE.2016.08.0.037",
"10.5656/KSAE.2016.05.0.020",
"10.5656/KSAE.2016.06.0.030",
"10.5656/KSAE.2016.06.0.032",
"10.5656/KSAE.2016.05.0.010",
"10.5656/KSAE.2016.08.0.027",
"10.5656/KSAE.2016.07.0.038",
"10.5656/KSAE.2016.08.0.016",
"10.5656/KSAE.2016.09.0.023",
"10.5656/KSAE.2016.08.0.043",
"10.5656/KSAE.2016.08.0.040",
"10.5656/KSAE.2016.09.0.012",
"10.5656/KSAE.2016.07.0.039",
"10.5656/KSAE.2016.10.0.026",
"10.5656/KSAE.2016.09.0.035",
"10.5656/KSAE.2016.10.0.042",
"10.5656/KSAE.2016.10.0.057",
"10.5656/KSAE.2016.10.0.049",
"10.5656/KSAE.2016.10.0.062",
"10.5656/KSAE.2016.11.0.041",
"10.5656/KSAE.2016.10.0.059",
"10.5656/KSAE.2016.11.0.060",
"10.5656/KSAE.2016.09.0.054",
"10.5656/KSAE.2016.11.0.029",
"10.5656/KSAE.2016.10.0.065",
"10.5656/KSAE.2016.11.0.051",
"10.5656/KSAE.2016.10.0.047",
"10.5656/KSAE.2016.08.0.046",
"10.5656/KSAE.2016.11.0.072",
"10.5656/KSAE.2016.06.1.036",
"10.5656/KSAE.2016.08.0.04",
"10.5656/KSAE.2016.11.0.053",
"10.5656/KSAE.2016.11.0.070",
"10.5656/KSAE.2016.11.0.073",
"10.5656/KSAE.2016.11.0.077",
"10.5656/KSAE.2016.11.0.068",
"10.5656/KSAE.2016.11.0.061",
"10.5656/KSAE.2016.11.0.063",
"10.5656/KSAE.2016.11.0.056",
"10.5656/KSAE.2016.11.0.045",
"10.5656/KSAE.2017.02.1.058",
"10.5656/KSAE.2017.01.1.083",
"10.5656/KSAE.2017.02.1.086",
"10.5656/KSAE.2016.10.0.033",
"10.5656/KSAE.2016.11.0.069",
"10.5656/KSAE.2016.11.0.076",
"10.5656/KSAE.2017.02.1.079",
"10.5656/KSAE.2017.03.1.087",
"10.5656/KSAE.2017.01.1.064",
"10.5656/KSAE.2017.03.1.067",
"10.5656/KSAE.2017.03.0.007",
"10.5656/KSAE.2017.02.1.090",
"10.5656/KSAE.2017.03.0.008",
"10.5656/KSAE.2017.03.0.003",
"10.5656/KSAE.2017.04.0.002",
"10.5656/KSAE.2017.03.0.005",
"10.5656/KSAE.2017.05.0.016",
"10.5656/KSAE.2016.11.0.074",
"10.5656/KSAE.2017.02.1.050",
"10.5656/KSAE.2017.05.1.082",
"10.5656/KSAE.2017.05.1.081",
"10.5656/KSAE.2017.56.3.",
"10.5656/KSAE.2016.08.0.036",
"10.5656/KSAE.2017.03.1.052",
"10.5656/KSAE.2017.05.0.001",
"10.5656/KSAE.2017.05.0.010",
"10.5656/KSAE.2017.05.0.013",
"10.5656/KSAE.2017.04.1.088",
"10.5656/KSAE.2017.06.0.014",
"10.5656/KSAE.2017.06.0.009",
"10.5656/KSAE.2017.06.0.004",
"10.5656/KSAE.2017.05.0.015",
"10.5656/KSAE.2017.08.0.019",
"10.5656/KSAE.2017.08.0.020",
);

$dois = array(
'10.5656/KSAE.2008.47.3.273',
'10.5656/KSAE.2010.49.4.363',
'10.5656/KSAE.2010.49.3.175',
'10.5656/KSAE.2012.01.0.001'
);

$dois = array(
'10.12782/specdiv.24.61'
);


$count = 1;

foreach ($dois as $doi)
{
	// DOI prefix
	$parts = explode('/', $doi);
	$prefix = $parts[0];
	
	// Agency lookup
	$agency = doi_to_agency($prefix_to_agency, $prefix, $doi);

	$doi = strtolower($doi);	
	$url = 'https://doi.org/' . $doi;	
	$json = get($url, 'application/vnd.citationstyles.csl+json');
	$obj = json_decode($json);
	
	//print_r($obj);
	
	if ($obj)	
	{
		if ($agency != '')
		{
			$obj->doi_agency = $agency;
		}
	
		$sql = csl_to_sql($obj);		
		echo $sql . "\n";
	}
	
	// Give server a break every 10 items
	if (($count++ % 10) == 0)
	{
		$rand = rand(1000000, 3000000);
		echo "\n-- ...sleeping for " . round(($rand / 1000000),2) . ' seconds' . "\n\n";
		usleep($rand);
	}
	

}

// save prefix file
file_put_contents($prefix_filename, json_encode($prefix_to_agency, JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE));

?>
